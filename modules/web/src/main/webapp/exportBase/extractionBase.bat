@echo off
setlocal enabledelayedexpansion

echo "set table"
set table_list=(groupe entreprise transmission service paramsgeneraux fichemetier salarie metier parcours entretien typeabsence absence remuneration typehabilitation habilitation fichedeposte fichemetierentreprise ref_revenu_complementaire lien_remuneration_revenu_complementaire formation accident evenement contrat_travail pieces_justificatives personne_a_charge objectifsentretien admin gpec_user)

set "groupe_column_list=id_groupe,nom_groupe"
set "entreprise_column_list=id_entreprise,NOM_ENTREPRISE,NUMSIRET,CODEAPE,DATE_CREATION,CCI_RATTACHEMENT,JUSTIFICATIF,SUIVI_FORMATIONS,SUIVI_ACCIDENTS,SUIVI_ABSENCES,SUIVI_COMPETENCES,SUIVI_DIF,DIf_MAX,ID_GROUPE"
set "transmission_column_list=id_transmission,date_derniere_demande,date_transmission"
set "service_column_list=id_service,nom_service,id_entreprise"
set "paramsgeneraux_column_list=id_params_generaux,AGE_LEGAL_RETRAITE_AN_N,AGE_LEGAL_RETRAITE_AN_N_1,AGE_LEGAL_RETRAITE_AN_N_2,DUREE_TRAVAIL_AN_N_HEURES_REALISEES_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_1_HEURES_REALISEES_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_2_HEURES_REALISEES_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_JOURS_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_1_JOURS_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_2_JOURS_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_JOURS_SAL,DUREE_TRAVAIL_AN_N_1_JOURS_SAL,DUREE_TRAVAIL_AN_N_2_JOURS_SAL,DUREE_TRAVAIL_AN_N_HEURES_SAL,DUREE_TRAVAIL_AN_N_1_HEURES_SAL,DUREE_TRAVAIL_AN_N_2_HEURES_SAL,ID_ENTREPRISE,MASSE_SALARIALE_AN_N,MASSE_SALARIALE_AN_N_1,MASSE_SALARIALE_AN_N_2,EFFECTIF_MOYEN_AN_N,EFFECTIF_MOYEN_AN_N_1,EFFECTIF_MOYEN_AN_N_2,POURCENTAGE_FORMATION_AN_N,POURCENTAGE_FORMATION_AN_N_1,POURCENTAGE_FORMATION_AN_N_2,EFFECTIF_PHYSIQUE_AN_N,EFFECTIF_PHYSIQUE_AN_N_1,EFFECTIF_PHYSIQUE_AN_N_2,EFFECTIF_ETP_AN_N,EFFECTIF_ETP_AN_N_1,EFFECTIF_ETP_AN_N_2,ANNEE"
set "fichemetier_column_list=id_fiche_metier,FINALITE_METIER,SAVOIR_FAIRE,ACTIVITES_RESPONSABILITES,INTITULE_METIER_TYPE,CSP_REFERENCE,NIVEAU_FORMATION_REQUIS,SAVOIR_ETRE,SAVOIR,PARTICULIARITE,JUSTIFICATIF"
set "salarie_column_list=id_salarie,CIVILITE,NOM,PRENOM,ADRESSE,DATE_NAISSANCE,LIEU_NAISSANCE,TELEPHONE,CREDIT_DIF,ID_LIEN_SUBORDINATION,NIV_FORMATION_INIT,NIV_FORMATION_ATTEINT,CV,PRESENT,IMPRESSION,POSSEDE_PERMIS_CONDUIRE,DATE_LAST_SAISIE_DIF,TELEPHONE_PORTABLE,SITUATION_FAMILIALE,PERSONNE_A_PREVENIR_NOM,PERSONNE_A_PREVENIR_PRENOM,PERSONNE_A_PREVENIR_ADRESSE,PERSONNE_A_PREVENIR_TELEPHONE,PERSONNE_A_PREVENIR_LIEN_PARENTE,COMMENTAIRE,ID_ENTREPRISE,ID_SERVICE"
set "metier_column_list=id_metier,nom_metier,difficultes,id_famille_metier"
set "parcours_column_list=id_parcours,DEBUT_FONCTION,FIN_FONCTION,EQUIVALENCE_TEMPS_PLEIN,JUSTIFICATIF,COEFFICIENT,NIVEAU,ECHELON,ID_METIER,ID_TYPE_CONTRAT,ID_SALARIE,ID_STATUT,ID_TYPE_RECOURS"
set "entretien_column_list=id_entretien,PRINCIPALE_CONCLUSION,SOUHAIT,COMPETENCE,DATE_ENTRETIEN,CR_SIGNE,OBJ_MOYENS,SERVICE_MANAGER,FORMATION_N_MOINS_UN,COMMENTAIRE_FORMATION,MODIF_PROFIL,BILAN_DESSOUS,BILAN_EGAL,OBSERVATIONS,BILAN_DESSUS,FORMATIONS,FORMATIONS2,FORMATIONS3,FORMATIONS4,FORMATIONS5,COMMENTAIRE_BILAN,OBJ_DELAIS,EVOLUTION_PERSO,SYNTHESE,NOM_MANAGER,OBJ_INTITULE,OBJ_CRITERES,DOMAINES_FORMATION,DOMAINES_FORMATION2,DOMAINES_FORMATION3,DOMAINES_FORMATION4,DOMAINES_FORMATION5,JUSTIFICATIF,ID_SALARIE,EVALUATION_GLOBALE,ANNEE_REFERENCE"
set "typeabsence_column_list=id_type_absence,nom_type_absence"
set "absence_column_list=id_absence,DEBUT_ABSENCE,FIN_ABSENCE,NOMBRE_JOUR_OUVRE,JUSTIFICATIF,ID_TYPE_ABSENCE,ID_SALARIE"
set "remuneration_column_list=id_remuneration,HEURES_SUP_50_COMMENTAIRE,AUGMENTATION_COLLECTIVE,HEURES_SUP_50,SALAIRE_MENSUEL_CENVENTIONNEL_BRUT,ANNEE,NIVEAU,SALAIRE_MINIMUM_CONVENTIONNEL_ACTUALISATION,AUGMENTATION_COLLECTIVE_ACTUALISATION,SALAIRE_DE_BASE_ACTUALISATION,HORAIRE_MENSUEL_TRAVAILLE,ID_METIER,SALAIRE_MINIMUM_CONVENTIONNEL_COMMENTAIRE,ECHELON,SALAIRE_DE_BASE,SALAIRE_DE_BASE_COMMENTAIRE,HEURES_SUP_25_ACTUALISATION,COMMENTAIRE,AUGMENTATION_INDIVIDUELLE,HEURES_SUP_25,HEURES_SUP_50_ACTUALISATION,ID_STATUT,TAUX_HORAIRE_BRUT,AUGMENTATION_INDIVIDUELLE_ACTUALISATION,AUGMENTATION_INDIVIDUELLE_COMMENTAIRE,COEFFICIENT,ID_REVENU_COMPLEMENTAIRE,SALAIRE_MINIMUM_CONVENTIONNEL,HEURES_SUP_25_COMMENTAIRE,AUGMENTATION_COLLECTIVE_COMMENTAIRE,SALAIRE_MENSUEL_BRUT,BASE_BRUTE_ANNUELLE,REMUNERATION_GLOBALE,HEURES_SUP_ANNUELLES,AVANTAGES_NON_ASSUJETTIS_ANNUELS,ID_SALARIE"
set "typehabilitation_column_list=id_type_habilitation,nom_type_habilitation"
set "habilitation_column_list=id_habilitation,DELIVRANCE,EXPIRATION,DUREE_VALIDITE,JUSTIFICATIF,COMMENTAIRE,ID_SALARIE,ID_TYPE_HABILITATION"
set "fichedeposte_column_list=id_fiche_de_poste,ID_SALARIE,ID_METIER_TYPE,DATE_MODIFICATION,COMPETENCES_SPECIFIQUES_TEXTE,COMPETENCES_SPECIFIQUES,SAVOIR,SAVOIR_FAIRE,SAVOIR_ETRE,EVALUATION_GLOBALE,CATEGORIE_COMPETENCE,CATEGORIE_COMPETENCE2,CATEGORIE_COMPETENCE3,CATEGORIE_COMPETENCE4,CATEGORIE_COMPETENCE5,MOBILITE_ENVISAGEE,COMMENTAIRES,DATE_CREATION,COMPETENCES_NOUVELLES,COMPETENCES_NOUVELLES2,COMPETENCES_NOUVELLES3,COMPETENCES_NOUVELLES4,COMPETENCES_NOUVELLES5,ACTIVITES_SPECIFIQUES,JUSTIFICATIF"
set "fichemetierentreprise_column_list=id_fiche_metier,id_entreprise"
set "ref_revenu_complementaire_column_list=id_revenu_complementaire,LIBELLE_REVENU_COMPLEMENTAIRE,TYPE_REVENU_COMPLEMENTAIRE"
set "lien_remuneration_revenu_complementaire_column_list=id_lien_remuneration_revenu_complementaire,MONTANT,COMMENTAIRE,ACTUALISATION,REMONTE_N_PREC,ID_REMUNERATION,ID_REVENU_COMPLEMENTAIRE"
set "formation_column_list=id_formation,DEBUT_FORMATION,FIN_FORMATION,NOM_FORMATION,ORGANISME_FORMATINO,MODE,VOLUME_HORAIRE,DIF,HORS_DIF,NOMBRE_JOUR_OUVRE,JUSTIFICATIF,COUT_OPCA,COUT_ENTREPRISE,COUT_AUTRE,ID_DOMAINE_FORMATION,ID_SALARIE,ID_ABSENCE"
set "accident_column_list=id_accident,INITIAL,AGGRAVATION,DATE_ACCIDENT,DATE_RECHUTE,NOMBRE_JOUR_ARRET,NOMBRE_JOUR_ARRET_RECHUTE,JUSTIFICATIF,COMMENTAIRE,ID_TYPE_LESION,ID_TYPE_LESION_RECHUTE,ID_TYPE_CAUSE_ACCIDENT,ID_TYPE_ACCIDENT,ID_SALARIE,ID_ABSENCE"
set "evenement_column_list=ID_EVENEMENT,DATE_EVENEMENT,COMMENTAIRE,INTERLOCUTEUR,NATURE,DECISION,JUSTIFICATIF,ID_SALARIE"
set "contrat_travail_column_list=ID_CONTRAT,DEBUT_CONTRAT,FIN_CONTRAT,RENOUVELLEMENT_CDD,JUSTIFICATIF,NATURE_CONTRAT,ID_METIER,ID_TYPE_CONTRAT,ID_SALARIE,ID_MOTIF_RUPTURE_CONTRAT"
set "pieces_justificatives_column_list=ID_PIECES_JUSTIFICATIVES,CARTE_IDENTITE,ATTESTATION_SECU,PERMIS_CONDUIRE,RIB,DIPLOMES,CERTIFICAT_TRAVAIL,ATTESTATION_VISITE_MEDICALE,HABILITATIONS,ID_SALARIE"
set "personne_a_charge_column_list=ID_PERSONNE_A_CHARGE,NOM,PRENOM,LIEN_PARENTE,DATE_NAISSANCE,ID_SALARIE"
set "objectifsentretien_column_list=ID_OBJECTIF,INTITULE,DELAI,MOYEN,RESULTAT,COMMENTAIRE,ID_ENTRETIEN"
set "admin_column_list=id_admin,migration,logo"
set "gpec_user_column_list=ID_USER,LOGIN,PASSWORD,EVENEMENT,REMUNERATION,FICHEDEPOSTE,ENTRETIEN,CONTRAT_TRAVAIL,ADMIN"

set "groupe_column_list_libelle=id_groupe,nom_groupe"
set "entreprise_column_list_libelle=id_entreprise,NOM_ENTREPRISE,NUMSIRET,CODEAPE,DATE_CREATION,CCI_RATTACHEMENT,JUSTIFICATIF,SUIVI_FORMATIONS,SUIVI_ACCIDENTS,SUIVI_ABSENCES,SUIVI_COMPETENCES,SUIVI_DIF,DIf_MAX,ID_GROUPE"
set "transmission_column_list_libelle=id_transmission,date_derniere_demande,date_transmission"
set "service_column_list_libelle=id_service,nom_service,id_entreprise"
set "paramsgeneraux_column_list_libelle=id_params_generaux,AGE_LEGAL_RETRAITE_AN_N,AGE_LEGAL_RETRAITE_AN_N_1,AGE_LEGAL_RETRAITE_AN_N_2,DUREE_TRAVAIL_AN_N_HEURES_REALISEES_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_1_HEURES_REALISEES_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_2_HEURES_REALISEES_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_JOURS_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_1_JOURS_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_2_JOURS_EFFECTIF_TOT,DUREE_TRAVAIL_AN_N_JOURS_SAL,DUREE_TRAVAIL_AN_N_1_JOURS_SAL,DUREE_TRAVAIL_AN_N_2_JOURS_SAL,DUREE_TRAVAIL_AN_N_HEURES_SAL,DUREE_TRAVAIL_AN_N_1_HEURES_SAL,DUREE_TRAVAIL_AN_N_2_HEURES_SAL,ID_ENTREPRISE,MASSE_SALARIALE_AN_N,MASSE_SALARIALE_AN_N_1,MASSE_SALARIALE_AN_N_2,EFFECTIF_MOYEN_AN_N,EFFECTIF_MOYEN_AN_N_1,EFFECTIF_MOYEN_AN_N_2,POURCENTAGE_FORMATION_AN_N,POURCENTAGE_FORMATION_AN_N_1,POURCENTAGE_FORMATION_AN_N_2,EFFECTIF_PHYSIQUE_AN_N,EFFECTIF_PHYSIQUE_AN_N_1,EFFECTIF_PHYSIQUE_AN_N_2,EFFECTIF_ETP_AN_N,EFFECTIF_ETP_AN_N_1,EFFECTIF_ETP_AN_N_2,ANNEE"
set "fichemetier_column_list_libelle=id_fiche_metier,FINALITE_METIER,SAVOIR_FAIRE,ACTIVITES_RESPONSABILITES,INTITULE_METIER_TYPE,CSP_REFERENCE,NIVEAU_FORMATION_REQUIS,SAVOIR_ETRE,SAVOIR,PARTICULIARITE,JUSTIFICATIF"
set "salarie_column_list_libelle=id_salarie,CIVILITE,NOM,PRENOM,ADRESSE,DATE_NAISSANCE,LIEU_NAISSANCE,TELEPHONE,CREDIT_DIF,ID_LIEN_SUBORDINATION,NIV_FORMATION_INIT,NIV_FORMATION_ATTEINT,CV,PRESENT,IMPRESSION,POSSEDE_PERMIS_CONDUIRE,DATE_LAST_SAISIE_DIF,TELEPHONE_PORTABLE,SITUATION_FAMILIALE,PERSONNE_A_PREVENIR_NOM,PERSONNE_A_PREVENIR_PRENOM,PERSONNE_A_PREVENIR_ADRESSE,PERSONNE_A_PREVENIR_TELEPHONE,PERSONNE_A_PREVENIR_LIEN_PARENTE,COMMENTAIRE,ID_ENTREPRISE,ID_SERVICE"
set "metier_column_list_libelle=id_metier,nom_metier,difficultes,id_famille_metier"
set "parcours_column_list_libelle=id_parcours,DEBUT_FONCTION,FIN_FONCTION,EQUIVALENCE_TEMPS_PLEIN,JUSTIFICATIF,COEFFICIENT,NIVEAU,ECHELON,ID_METIER,ID_TYPE_CONTRAT,ID_SALARIE,ID_STATUT,ID_TYPE_RECOURS"
set "entretien_column_list_libelle=id_entretien,PRINCIPALE_CONCLUSION,SOUHAIT,COMPETENCE,DATE_ENTRETIEN,CR_SIGNE,OBJ_MOYENS,SERVICE_MANAGER,FORMATION_N_MOINS_UN,COMMENTAIRE_FORMATION,MODIF_PROFIL,BILAN_DESSOUS,BILAN_EGAL,OBSERVATIONS,BILAN_DESSUS,FORMATIONS,FORMATIONS2,FORMATIONS3,FORMATIONS4,FORMATIONS5,COMMENTAIRE_BILAN,OBJ_DELAIS,EVOLUTION_PERSO,SYNTHESE,NOM_MANAGER,OBJ_INTITULE,OBJ_CRITERES,DOMAINES_FORMATION,DOMAINES_FORMATION2,DOMAINES_FORMATION3,DOMAINES_FORMATION4,DOMAINES_FORMATION5,JUSTIFICATIF,ID_SALARIE,EVALUATION_GLOBALE,ANNEE_REFERENCE"
set "typeabsence_column_list_libelle=id_type_absence,nom_type_absence"
set "absence_column_list_libelle=id_absence,DEBUT_ABSENCE,FIN_ABSENCE,NOMBRE_JOUR_OUVRE,JUSTIFICATIF,ID_TYPE_ABSENCE,ID_SALARIE"
set "remuneration_column_list_libelle=id_remuneration,HEURES_SUP_50_COMMENTAIRE,AUGMENTATION_COLLECTIVE,HEURES_SUP_50,SALAIRE_MENSUEL_CENVENTIONNEL_BRUT,ANNEE,NIVEAU,SALAIRE_MINIMUM_CONVENTIONNEL_ACTUALISATION,AUGMENTATION_COLLECTIVE_ACTUALISATION,SALAIRE_DE_BASE_ACTUALISATION,HORAIRE_MENSUEL_TRAVAILLE,ID_METIER,SALAIRE_MINIMUM_CONVENTIONNEL_COMMENTAIRE,ECHELON,SALAIRE_DE_BASE,SALAIRE_DE_BASE_COMMENTAIRE,HEURES_SUP_25_ACTUALISATION,COMMENTAIRE,AUGMENTATION_INDIVIDUELLE,HEURES_SUP_25,HEURES_SUP_50_ACTUALISATION,ID_STATUT,TAUX_HORAIRE_BRUT,AUGMENTATION_INDIVIDUELLE_ACTUALISATION,AUGMENTATION_INDIVIDUELLE_COMMENTAIRE,COEFFICIENT,ID_REVENU_COMPLEMENTAIRE,SALAIRE_MINIMUM_CONVENTIONNEL,HEURES_SUP_25_COMMENTAIRE,AUGMENTATION_COLLECTIVE_COMMENTAIRE,SALAIRE_MENSUEL_BRUT,BASE_BRUTE_ANNUELLE,REMUNERATION_GLOBALE,HEURES_SUP_ANNUELLES,AVANTAGES_NON_ASSUJETTIS_ANNUELS,ID_SALARIE"
set "typehabilitation_column_list_libelle=id_type_habilitation,nom_type_habilitation"
set "habilitation_column_list_libelle=id_habilitation,DELIVRANCE,EXPIRATION,DUREE_VALIDITE,JUSTIFICATIF,COMMENTAIRE,ID_SALARIE,ID_TYPE_HABILITATION"
set "fichedeposte_column_list_libelle=id_fiche_de_poste,ID_SALARIE,ID_METIER_TYPE,DATE_MODIFICATION,COMPETENCES_SPECIFIQUES_TEXTE,COMPETENCES_SPECIFIQUES,SAVOIR,SAVOIR_FAIRE,SAVOIR_ETRE,EVALUATION_GLOBALE,CATEGORIE_COMPETENCE,CATEGORIE_COMPETENCE2,CATEGORIE_COMPETENCE3,CATEGORIE_COMPETENCE4,CATEGORIE_COMPETENCE5,MOBILITE_ENVISAGEE,COMMENTAIRES,DATE_CREATION,COMPETENCES_NOUVELLES,COMPETENCES_NOUVELLES2,COMPETENCES_NOUVELLES3,COMPETENCES_NOUVELLES4,COMPETENCES_NOUVELLES5,ACTIVITES_SPECIFIQUES,JUSTIFICATIF"
set "fichemetierentreprise_column_list_libelle=id_fiche_metier,id_entreprise"
set "ref_revenu_complementaire_column_list_libelle=id_revenu_complementaire,LIBELLE_REVENU_COMPLEMENTAIRE,TYPE_REVENU_COMPLEMENTAIRE"
set "lien_remuneration_revenu_complementaire_column_list_libelle=id_lien_remuneration_revenu_complementaire,MONTANT,COMMENTAIRE,ACTUALISATION,REMONTE_N_PREC,ID_REMUNERATION,ID_REVENU_COMPLEMENTAIRE"
set "formation_column_list_libelle=id_formation,DEBUT_FORMATION,FIN_FORMATION,NOM_FORMATION,ORGANISME_FORMATINO,MODE,VOLUME_HORAIRE,DIF,HORS_DIF,NOMBRE_JOUR_OUVRE,JUSTIFICATIF,COUT_OPCA,COUT_ENTREPRISE,COUT_AUTRE,ID_DOMAINE_FORMATION,ID_SALARIE,ID_ABSENCE"
set "accident_column_list_libelle=id_accident,INITIAL,AGGRAVATION,DATE_ACCIDENT,DATE_RECHUTE,NOMBRE_JOUR_ARRET,NOMBRE_JOUR_ARRET_RECHUTE,JUSTIFICATIF,COMMENTAIRE,ID_TYPE_LESION,ID_TYPE_LESION_RECHUTE,ID_TYPE_CAUSE_ACCIDENT,ID_TYPE_ACCIDENT,ID_SALARIE,ID_ABSENCE"
set "evenement_column_list_libelle=ID_EVENEMENT,DATE_EVENEMENT,COMMENTAIRE,INTERLOCUTEUR,NATURE,DECISION,JUSTIFICATIF,ID_SALARIE"
set "contrat_travail_column_list_libelle=ID_CONTRAT,DEBUT_CONTRAT,FIN_CONTRAT,RENOUVELLEMENT_CDD,JUSTIFICATIF,NATURE_CONTRAT,ID_METIER,ID_TYPE_CONTRAT,ID_SALARIE,ID_MOTIF_RUPTURE_CONTRAT"
set "pieces_justificatives_column_list_libelle=ID_PIECES_JUSTIFICATIVES,CARTE_IDENTITE,ATTESTATION_SECU,PERMIS_CONDUIRE,RIB,DIPLOMES,CERTIFICAT_TRAVAIL,ATTESTATION_VISITE_MEDICALE,HABILITATIONS,ID_SALARIE"
set "personne_a_charge_column_list_libelle=ID_PERSONNE_A_CHARGE,NOM,PRENOM,LIEN_PARENTE,DATE_NAISSANCE,ID_SALARIE"
set "objectifsentretien_column_list_libelle=ID_OBJECTIF,INTITULE,DELAI,MOYEN,RESULTAT,COMMENTAIRE,ID_ENTRETIEN"
set "admin_column_list_libelle=id_admin,migration,logo"
set "gpec_user_column_list_libelle=ID_USER,LOGIN,PASSWORD,EVENEMENT,REMUNERATION,FICHEDEPOSTE,ENTRETIEN,CONTRAT_TRAVAIL,ADMIN"

set "groupe_join="
set "entreprise_join="
set "transmission_join="
set "service_join="
set "paramsgeneraux_join="
set "fichemetier_join="
set "salarie_join="
set "metier_join="
set "parcours_join="
set "entretien_join="
set "typeabsence_join="
set "absence_join="
set "remuneration_join="
set "typehabilitation_join="
set "habilitation_join="
set "fichedeposte_join="
set "fichemetierentreprise_join="
set "ref_revenu_complementaire_join="
set "lien_remuneration_revenu_complementaire_join="
set "formation_join="
set "accident_join="
set "evenement_join="
set "contrat_travail_join="
set "pieces_justificatives_join="
set "personne_a_charge_join="
set "objectifsentretien_join="
set "admin_join="
set "gpec_user_join="

echo "boucle"
set line=""
for %%i in %table_list% do (
	mysql.exe -u root --port=3307 -e "SELECT !%%i_column_list_libelle! UNION !%%i_column_list! into OUTFILE './../bin/%%i.xls' FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n'  FROM %%i x;" gpec_mysql_embedded
)

pause